## Split keyboards
## https://zmk.dev/docs/config/system#split-keyboards
CONFIG_ZMK_SPLIT_BLE_CENTRAL_PERIPHERALS=1
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_FETCHING=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_PROXY=y

## ZMK Studio - Move this to config/charybdis.conf when dongle works with ZMK Studio
## https://zmk.dev/docs/features/studio
CONFIG_ZMK_STUDIO=y
## https://zmk.dev/docs/config/studio
CONFIG_ZMK_STUDIO_LOCKING=y

CONFIG_ZMK_SPLIT_ROLE_CENTRAL=y
CONFIG_ZMK_INPUT_LISTENER=y

## Increase BLE central stack/queue for PMW3610 + BLE stability
## https://zmk.dev/docs/config/split
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_STACK_SIZE=1536
CONFIG_ZMK_SPLIT_BLE_CENTRAL_POSITION_QUEUE_SIZE=20
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_QUEUE_SIZE=10

## Relax split connection interval to reduce BLE radio contention with SPI
## Default INT=6 (7.5ms) fires too close to PMW3610 report intervals
CONFIG_ZMK_SPLIT_BLE_PREF_INT=12
CONFIG_ZMK_SPLIT_BLE_PREF_LATENCY=15

## More BLE TX buffers â€” GATT notification alloc blocks with K_FOREVER when exhausted,
## which deadlocks the system workqueue and permanently stalls PMW3610 IRQ re-enable
CONFIG_BT_L2CAP_TX_BUF_COUNT=8
CONFIG_BT_ATT_TX_COUNT=12
CONFIG_ZMK_BLE_THREAD_STACK_SIZE=1024